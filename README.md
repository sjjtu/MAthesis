# MAthesis
repo to store work for master thesis



# Data
We use the MIT BIH Arrhythmia dataset from https://physionet.org/content/mitdb/1.0.0/. It can be retrieved using the python package `wfdb`.

Downloading and preprocessing (test, train, validation split) is handled in the ```Preprocessor.py``` class and the ```preprocess.ipynb``` notebook.

# Models
We use two different models for times series data generation:
## AE-(dp)MERF
This model is based on the [DP-MERF model by Harder et al.](https://arxiv.org/abs/2002.11603) It uses the maximum mean discrepancy as a loss function for the generator and at the time of writing is considered to be the best all purpose data generator for tabular data. We added an autoencoder to transform the time series data into a latent representation of fixed dimension. DP-MERF is then employed in the latent space to generate encoded data which is then decoded back into the original space. 

Synthetic data generated by AE-dpMERF gave stable utility for anomaly detection for reasonable privacy budgets $\epsilon$.

## AE-(dp)WGAN
This model is based on the [RTSGAN model by Pei et al.](https://seqml.github.io/rtsgan/) It also uses an autoencoder architecture and Wasserstein GAN in the latent space to generate time series data. We did two modifications to the model:
- We exchanged the original autoencoder architecture with the one used in the AE-dpMERF model for comparability.
- For the DP version, we needed to enforce the Lipschitz condition with a strict bound on the gradients instead of adding a penalty term. Otherwise, the architecture would not be compatible with the `opacus` library.

Synthetic data generated by AE-dpWGAN gave low utility for anomaly detection for even higher privacy budgets $\epsilon$.